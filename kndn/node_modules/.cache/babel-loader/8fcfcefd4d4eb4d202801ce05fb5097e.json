{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\lappv\\\\Desktop\\\\KNDN\\\\kndn\\\\src\\\\app\\\\pages\\\\interact\\\\InteractWrapper.jsx\";\n\n/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React, { FC, useState, useEffect, useRef } from 'react';\nimport { useIntl } from 'react-intl';\nimport { KTSVG, toAbsoluteUrl } from '../../../_metronic/helpers';\nimport { CONFIG } from '../../../helpers/config';\nimport { requestPOST, requestGET } from '../../../helpers/baseAPI';\nimport { useSelector } from 'react-redux';\nimport { useParams } from 'react-router-dom';\nimport { Button } from 'antd';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst InteractPage = () => {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"col-xl-12\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 13,\n    columnNumber: 10\n  }, this);\n};\n\nconst InteractWrapper = _ref => {\n  let {\n    messages\n  } = _ref;\n  const {\n    id\n  } = useParams();\n  const accessToken = useSelector(state => state.auth.accessToken);\n  const user = useSelector(state => state.auth.user);\n  const intl = useIntl();\n  const [chatlist, setChatList] = useState([]);\n  const [detailChat, setDetailChat] = useState([]);\n  const [contentChat, setContentChat] = useState(\"\");\n  const [loading, setLoading] = useState(true);\n  const divRef = useRef(null);\n  useEffect(() => {\n    const fetchData = async () => {\n      var _res$data$ThongTinTuo, _res$data;\n\n      var body = {\n        \"token\": accessToken,\n        \"idPhanAnh\": id\n      };\n      let res = await requestPOST(CONFIG.PAHT_PATH + '/DanhSachTuongTac', body);\n      let data = (_res$data$ThongTinTuo = res === null || res === void 0 ? void 0 : (_res$data = res.data) === null || _res$data === void 0 ? void 0 : _res$data.ThongTinTuongTac) !== null && _res$data$ThongTinTuo !== void 0 ? _res$data$ThongTinTuo : [];\n\n      if (data) {\n        setDetailChat(data);\n        console.log(data);\n      }\n    };\n\n    try {\n      if (loading) {\n        fetchData();\n        setLoading(false);\n      }\n    } catch (error) {}\n\n    return () => {\n      setDetailChat([]);\n    };\n  }, [loading]);\n  const messagesEndRef = useRef(null);\n\n  const scrollToBottom = () => {\n    var _messagesEndRef$curre;\n\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: \"smooth\"\n    });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  const postTuongTac = async () => {\n    console.log(accessToken);\n    var body = {\n      \"token\": accessToken,\n      \"TuongTac\": {\n        \"PhanAnhID\": id,\n        \"NoiDung\": contentChat,\n        \"Loai\": \"CongDan\"\n      }\n    };\n    let res = await requestPOST(CONFIG.PAHT_PATH + \"/CreateTuongTac\", body);\n\n    if (res != null) {\n      setContentChat(\"\");\n      setLoading(true);\n      scrollToBottom();\n      console.log(\"Gửi tin nhắn thành công\");\n    } else {\n      console.log(\"Gửi thất bại\");\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(InteractPage, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"row\",\n      style: {\n        backgroundColor: \"white\",\n        height: \"700px\"\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-12\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card-header\",\n          children: /*#__PURE__*/_jsxDEV(\"h4\", {\n            style: {\n              textAlign: \"center\",\n              paddingTop: \"15px\"\n            },\n            children: \"N\\u1ED9i dung chat\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"ContentChat\",\n          className: \"scroll-y me-n5 pe-5 h-500px mb-5\",\n          ref: messagesEndRef,\n          children: detailChat === null || detailChat === void 0 ? void 0 : detailChat.map(cont => /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: \"flex\",\n              padding: \"2px\",\n              justifyContent: (cont === null || cont === void 0 ? void 0 : cont.Loai) === \"CanBo\" ? \"flex-start\" : \"flex-end\"\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: (cont === null || cont === void 0 ? void 0 : cont.Loai) === \"CanBo\" ? 'p-5 rounded bg-light-info text-dark fw-bold mw-lg-400px text-start' : 'p-5 rounded bg-light-primary text-dark fw-bold mw-lg-400px text-end',\n              children: cont.NoiDung\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 103,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 106,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"row card-footer pt-4\",\n          style: {},\n          children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n            className: \"col-9 form-control form-control-flush mb-3\\\"\",\n            placeholder: \"Type a message\",\n            value: contentChat,\n            autoFocus: true,\n            title: \"N\\u1ED9i dung g\\u1EEDi\",\n            rows: \"1\",\n            onChange: e => {\n              setContentChat(e.target.value);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"d-flex flex-stack\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"d-flex align-items-center me-2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 120,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn btn-primary\",\n              type: \"buton\",\n              title: \"G\\u1EEDi tin nh\\u1EAFn\",\n              onClick: () => {\n                postTuongTac();\n              },\n              children: \"G\\u1EEDi\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 122,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n\nexport { InteractWrapper };","map":{"version":3,"names":["React","FC","useState","useEffect","useRef","useIntl","KTSVG","toAbsoluteUrl","CONFIG","requestPOST","requestGET","useSelector","useParams","Button","InteractPage","InteractWrapper","messages","id","accessToken","state","auth","user","intl","chatlist","setChatList","detailChat","setDetailChat","contentChat","setContentChat","loading","setLoading","divRef","fetchData","body","res","PAHT_PATH","data","ThongTinTuongTac","console","log","error","messagesEndRef","scrollToBottom","current","scrollIntoView","behavior","postTuongTac","backgroundColor","height","textAlign","paddingTop","map","cont","display","padding","justifyContent","Loai","NoiDung","e","target","value"],"sources":["C:/Users/lappv/Desktop/KNDN/kndn/src/app/pages/interact/InteractWrapper.jsx"],"sourcesContent":["/* eslint-disable jsx-a11y/anchor-is-valid */\r\nimport React, { FC, useState, useEffect, useRef } from 'react'\r\nimport { useIntl } from 'react-intl'\r\nimport { KTSVG, toAbsoluteUrl } from '../../../_metronic/helpers'\r\nimport { CONFIG } from '../../../helpers/config'\r\nimport { requestPOST, requestGET } from '../../../helpers/baseAPI'\r\nimport { useSelector } from 'react-redux'\r\nimport { useParams } from 'react-router-dom'\r\nimport { Button } from 'antd'\r\n\r\nconst InteractPage = () => {\r\n\r\n  return <div className='col-xl-12'></div>\r\n}\r\n\r\nconst InteractWrapper = ({messages}) => {\r\n  const {id} = useParams();\r\n  const accessToken = useSelector(state => state.auth.accessToken)\r\n  const user = useSelector((state) => state.auth.user)\r\n  const intl = useIntl()\r\n  const [chatlist, setChatList] = useState([]);\r\n  const [detailChat, setDetailChat] = useState([]);\r\n  const [contentChat, setContentChat] = useState(\"\");\r\n  const [loading, setLoading] = useState(true);\r\n  const divRef = useRef(null)\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      var body = {\r\n        \"token\" : accessToken,\r\n        \"idPhanAnh\": id\r\n      }\r\n      let res = await requestPOST(CONFIG.PAHT_PATH +'/DanhSachTuongTac', body)\r\n      let data = res?.data?.ThongTinTuongTac ?? []\r\n      if (data) {\r\n        setDetailChat(data)\r\n        console.log(data)\r\n      }\r\n    }\r\n    try {\r\n      if (loading) {\r\n        fetchData()\r\n        setLoading(false)\r\n      }\r\n    } catch (error) { }\r\n    return () => {\r\n      setDetailChat([])\r\n    }\r\n  }, [loading])\r\n\r\n  const messagesEndRef = useRef(null)\r\n\r\n  const scrollToBottom = () => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" })\r\n  }\r\n\r\n  useEffect(() => {\r\n    scrollToBottom()\r\n  }, [messages]);\r\n  const postTuongTac = async () => {\r\n    console.log(accessToken)\r\n\r\n    var body = {\r\n      \"token\": accessToken,\r\n      \"TuongTac\": {\r\n        \"PhanAnhID\": id,\r\n        \"NoiDung\": contentChat,\r\n        \"Loai\": \"CongDan\"\r\n      }\r\n    }\r\n    let res = await requestPOST(CONFIG.PAHT_PATH + \"/CreateTuongTac\", body)\r\n    if (res != null) {\r\n      setContentChat(\"\")\r\n      setLoading(true)\r\n      scrollToBottom()\r\n      console.log(\"Gửi tin nhắn thành công\")\r\n    }\r\n    else {\r\n      console.log(\"Gửi thất bại\")\r\n    }\r\n  }\r\n  return (\r\n    <>\r\n      <InteractPage />\r\n      <div className='row' style={{ backgroundColor: \"white\", height: \"700px\" }}>\r\n        {/* <div className='col-3 pl-0' style={{ borderRight: \"1px solid #efe6e6\" }}>\r\n          <div>\r\n          </div>\r\n        </div> */}\r\n        <div className='col-12'>\r\n          <div className='card-header'>\r\n            <h4 style={{ textAlign: \"center\", paddingTop: \"15px\" }}>\r\n              Nội dung chat\r\n            </h4>\r\n          </div>\r\n          <div id=\"ContentChat\" className='scroll-y me-n5 pe-5 h-500px mb-5' ref={messagesEndRef} >\r\n            {detailChat?.map((cont) =>\r\n              <div style={{\r\n                display: \"flex\",\r\n                padding: \"2px\",\r\n                justifyContent: (cont?.Loai === \"CanBo\") ? \"flex-start\" : \"flex-end\"\r\n              }}>\r\n                <div className={(cont?.Loai === \"CanBo\") ? 'p-5 rounded bg-light-info text-dark fw-bold mw-lg-400px text-start' : 'p-5 rounded bg-light-primary text-dark fw-bold mw-lg-400px text-end'}>\r\n                  {cont.NoiDung}\r\n                </div>\r\n                <div  />\r\n              </div>\r\n            )}\r\n          </div>\r\n          <div className='row card-footer pt-4' style={{}}>\r\n            <textarea className='col-9 form-control form-control-flush mb-3\"'\r\n              placeholder=\"Type a message\"\r\n              value={contentChat}\r\n              autoFocus = {true}\r\n              title='Nội dung gửi'\r\n              rows={\"1\"}\r\n              onChange={(e) => { setContentChat(e.target.value) }}>\r\n            </textarea>\r\n            <div className='d-flex flex-stack'>\r\n              <div className='d-flex align-items-center me-2'>\r\n              </div>\r\n              <button className='btn btn-primary' type='buton' title='Gửi tin nhắn' onClick={() => { postTuongTac() }}>\r\n                Gửi\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n        </div>\r\n      </div>\r\n    </>\r\n  )\r\n}\r\n\r\nexport { InteractWrapper }\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}